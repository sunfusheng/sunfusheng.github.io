I"E”<p>ä¸Šä¸€ç¯‡<a href="http://www.jianshu.com/p/b8197dd2934c">ã€çº¿ç¨‹ã€å¤šçº¿ç¨‹ä¸çº¿ç¨‹æ± æ€»ç»“ã€‘</a>ä¸­ä¸»è¦è®°å½•çº¿ç¨‹ã€å¤šçº¿ç¨‹ç›¸å…³æ¦‚å¿µï¼Œä¾§é‡äºçº¿ç¨‹çš„Futureä½¿ç”¨ä¸çº¿ç¨‹æ± çš„æ“ä½œï¼›åŒæ ·è¿™ä¸€ç¯‡ã€åå°„ã€æ³¨è§£ä¸ä¾èµ–æ³¨å…¥æ€»ç»“ã€‘ä¾ç„¶ç€é‡äºç›¸å…³æ¦‚å¿µä¸ä½¿ç”¨ã€‚<br /><br />
ç°åœ¨åœ¨æˆ‘ä»¬æ„å»ºè‡ªå·±æˆ–å…¬å¸çš„é¡¹ç›®ä¸­ï¼Œæˆ–å¤šæˆ–å°‘éƒ½ä¼šä¾èµ–å‡ ä¸ªæµè¡Œæ¯”è¾ƒå±Œçš„ç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚ï¼š<a href="https://github.com/JakeWharton/butterknife">Butter Knife</a>ã€<a href="https://github.com/square/retrofit">Retrofit</a>ã€<a href="https://github.com/google/dagger">Dagger 2</a>ç­‰ï¼Œå¦‚æœä½ æ²¡ç”¨è¿‡ï¼Œé‚£ä½ éœ€è¦æ‰¾æ—¶é—´è¡¥ä¸€ä¸‹å•¦ï¼›æœ‰æ—¶åœ¨ä½¿ç”¨åæˆ‘ä»¬ä¼šå¥½å¥‡ä»–ä»¬åˆ°åº•æ˜¯æ€ä¹ˆåšåˆ°è¿™ç§ç®€æ´ã€é«˜æ•ˆã€æ¾è€¦åˆç­‰è¯¸å¤šä¼˜ç‚¹çš„ï¼Œå½“ç„¶è¿™é‡Œæˆ‘ä¸æ¢è®¨å®ƒä»¬å…·ä½“æ€ä¹ˆå®ç°çš„ï¼Œè€Œå…³å¿ƒçš„æ˜¯å®ƒä»¬éƒ½ç”¨åˆ°åŒæ ·çš„æŠ€æœ¯åå°„å’Œæ³¨è§£ï¼Œå¹¶å®ç°çš„ä¾èµ–æ³¨å…¥ã€‚</p>

<p>å¦‚æœä½ å¥½å¥‡è¿™äº›åº“å…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œæˆ–è€…æƒ³äº†è§£ä»–ä»¬å®ç°çš„åŸç†ï¼Œè¿™é‡Œå‘ä½ æ¨èå‡ ç¯‡æ–‡ç« ï¼š<br />
1ã€<a href="http://www.jianshu.com/p/6f7a04488462">androidæ³¨è§£Butterknifeçš„ä½¿ç”¨åŠä»£ç åˆ†æ</a><br />
2ã€<a href="http://xuzhengchao.com/java/retrofit-source-code.html">Retrofitæºç 1: ä¸ºä»€ä¹ˆå†™ä¸€ä¸ªinterfaceå°±å¯ä»¥å®ç°httpè¯·æ±‚</a><br />
3ã€<a href="http://www.jianshu.com/p/45cb536be2f4">Retrofitåˆ†æ-æ¼‚äº®çš„è§£è€¦å¥—è·¯</a>  <br />
4ã€<a href="http://a.codekk.com/detail/Android/%E6%89%94%E7%89%A9%E7%BA%BF/Dagger%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90">Dagger æºç è§£æ</a><br />
5ã€<a href="http://www.jianshu.com/p/cd2c1c9f68d4">Androidï¼šdagger2è®©ä½ çˆ±ä¸é‡Šæ‰‹ï¼åŸºç¡€ä¾èµ–æ³¨å…¥æ¡†æ¶ç¯‡</a><br />
6ã€<a href="http://www.jianshu.com/p/1d42d2e6f4a5">Androidï¼šdagger2è®©ä½ çˆ±ä¸é‡Šæ‰‹ï¼é‡ç‚¹æ¦‚å¿µè®²è§£ã€èåˆç¯‡</a><br />
7ã€<a href="http://www.jianshu.com/p/65737ac39c44">Androidï¼šdagger2è®©ä½ çˆ±ä¸é‡Šæ‰‹ï¼ç»ˆç»“ç¯‡</a></p>

<p>è¿™äº›å¥½æ–‡ç« å·²ç»å¸®ä½ æ”¶è—äº†ï¼Œä¸‹é¢ç›´æ¥è¿›å…¥æˆ‘çš„ä¸»é¢˜ã€åå°„ã€æ³¨è§£ä¸ä¾èµ–æ³¨å…¥æ€»ç»“ã€‘ã€‚</p>

<h2 id="-åå°„reflection">â— åå°„ï¼ˆReflectionï¼‰</h2>

<h4 id="åå°„çš„æ¦‚å¿µ">åå°„çš„æ¦‚å¿µ</h4>

<p>ä¸»è¦æ˜¯æŒ‡ç¨‹åºå¯ä»¥è®¿é—®ï¼Œæ£€æµ‹å’Œä¿®æ”¹å®ƒæœ¬èº«çŠ¶æ€æˆ–è¡Œä¸ºçš„ä¸€ç§èƒ½åŠ›ï¼Œå¹¶èƒ½æ ¹æ®è‡ªèº«è¡Œä¸ºçš„çŠ¶æ€å’Œç»“æœï¼Œè°ƒæ•´æˆ–ä¿®æ”¹åº”ç”¨æ‰€æè¿°è¡Œä¸ºçš„çŠ¶æ€å’Œç›¸å…³çš„è¯­ä¹‰ã€‚</p>

<p>æ¦‚å¿µçœ‹ç€å°±æœ‰äº›æ™•æˆ–ä¸çŸ¥æ‰€äº‘å•¦ï¼Œå¯ä»¥é€šè¿‡åå°„çš„ä½œç”¨ç†è§£å®ƒçš„æ¦‚å¿µã€‚</p>

<h4 id="åå°„çš„ä½œç”¨">åå°„çš„ä½œç”¨</h4>

<p>åå°„å¯ä»¥è®©æˆ‘ä»¬åœ¨è¿è¡Œæ—¶è·å–ç±»çš„å±æ€§ï¼Œæ–¹æ³•ï¼Œæ„é€ æ–¹æ³•ã€çˆ¶ç±»ã€æ¥å£ç­‰ä¿¡æ¯ï¼Œé€šè¿‡åå°„è¿˜å¯ä»¥è®©æˆ‘ä»¬åœ¨è¿è¡ŒæœŸå®ä¾‹åŒ–å¯¹è±¡ã€è°ƒç”¨æ–¹æ³•ã€å³ä½¿æ–¹æ³•æˆ–å±æ€§æ˜¯ç§æœ‰çš„çš„ä¹Ÿå¯ä»¥é€šè¿‡åå°„çš„å½¢å¼è°ƒç”¨ã€‚</p>

<p>æ‰€æœ‰ä¸ºä»€ä¹ˆç¬¬ä¸‰æ–¹åº“åŸºæœ¬éƒ½ä¼šä½¿ç”¨åˆ°åå°„ï¼Œæ­£æ˜¯å› ä¸ºåå°„è¿™ç§ â€œçœ‹é€ Classâ€ çš„èƒ½åŠ›ã€‚</p>

<h4 id="åå°„ç›¸å…³çš„ç±»æ–¹æ³•">åå°„ç›¸å…³çš„ç±»ã€æ–¹æ³•</h4>

<p>è¦çœ‹é€ä¸€ä¸ªç±»ï¼Œé¦–å…ˆè¦è·å–è¿™ä¸ªç±»çš„å¯¹è±¡ï¼Œå…¶å®ƒä¿¡æ¯éƒ½æ˜¯é€šè¿‡è¿™ä¸ªå¯¹è±¡è·å–çš„ï¼Œä¸‹é¢çš„æ‰€æœ‰çš„ç¤ºä¾‹å…·ä½“æ“ä½œä»£ç è¯·å‚è€ƒ <a href="https://github.com/sunfusheng/In-depthStudy">ã€ä¸ªäººå­¦ä¹ é¡¹ç›®DroidStudyã€‘</a>ï¼Œæˆ‘åœ¨è¿™ä¸ªå·¥ç¨‹ä¸‹æ–°å»ºä¸€ä¸ª ReflectionActivityï¼ŒåŒ…çš„è·¯å¾„ä¸º com.sun.study.ui.activity.ReflectionActivityï¼Œé€šè¿‡åå°„ç›¸å…³çš„ç±»ã€æ–¹æ³•è®©æˆ‘çœ‹é€è¿™ä¸ªç±»ã€‚</p>

<p>1ã€è·å–å¯¹è±¡çš„ä¸‰ç§æ–¹å¼ï¼š</p>

<p>ç¬¬ä¸€ç§ã€çŸ¥é“ä¸€ä¸ªç±»ï¼Œç›´æ¥è·å– Class å¯¹è±¡</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls1</span> <span class="o">=</span> <span class="nc">ReflectionActivity</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</code></pre></div></div>

<p>ç¬¬äºŒç§ã€å¦‚æœå·²ç»å¾—åˆ°äº†æŸä¸ªå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡è·å– Class å¯¹è±¡</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nc">ReflectionActivity</span> <span class="n">activity</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ReflectionActivity</span><span class="o">();</span>
	<span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls2</span> <span class="o">=</span> <span class="n">activity</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span>
</code></pre></div></div>

<p>ç¬¬ä¸‰ç§ã€å¦‚æœä½ åœ¨ç¼–è¯‘æœŸè·å–ä¸åˆ°ç›®æ ‡ç±»å‹ï¼Œä½†æ˜¯ä½ çŸ¥é“å®ƒçš„å®Œæ•´ç±»è·¯å¾„ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å½¢å¼æ¥è·å– Class å¯¹è±¡ï¼Œè¿™æ ·è·å–å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ ClassNotFoundExceptionã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="k">try</span> <span class="o">{</span>
		<span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls3</span> <span class="o">=</span> <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.sun.study.ui.activity.ReflectionActivity"</span><span class="o">);</span>
	<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">ClassNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
	<span class="o">}</span>
</code></pre></div></div>

<p>2ã€åå°„çš„ç›¸å…³æ–¹æ³•å’Œç¤ºä¾‹</p>

<p>åˆ—å‡ºåå°„çš„ç›¸å…³æ–¹æ³•</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="n">getName</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å¾—ç±»çš„å®Œæ•´åå­—</span><span class="err">ã€‚</span>  
	<span class="n">newInstance</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">é€šè¿‡ç±»çš„ä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•åˆ›å»ºè¿™ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡</span><span class="err">ã€‚</span>

	<span class="n">getFields</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å¾—ç±»çš„publicç±»å‹çš„å±æ€§</span><span class="err">ã€‚</span>  
	<span class="n">getDeclaredFields</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å¾—ç±»çš„æ‰€æœ‰å±æ€§</span><span class="err">ã€‚</span>

	<span class="n">getMethods</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å¾—ç±»çš„publicç±»å‹çš„æ–¹æ³•</span><span class="err">ã€‚</span>  
	<span class="n">getDeclaredMethods</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å¾—ç±»çš„æ‰€æœ‰æ–¹æ³•</span><span class="err">ã€‚</span>  
	<span class="n">getMethod</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Class</span><span class="o">[]</span> <span class="n">parameterTypes</span><span class="o">)</span><span class="err">ï¼š</span><span class="n">è·å¾—ç±»çš„ç‰¹å®šæ–¹æ³•</span><span class="err">ã€‚</span>
	
	<span class="n">getModifiers</span><span class="o">()</span><span class="n">å’ŒModifier</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å¾—å±ä¿®é¥°ç¬¦</span><span class="err">ï¼Œ</span><span class="n">ä¾‹å¦‚private</span><span class="err">ï¼Œ</span><span class="kd">public</span><span class="err">ï¼Œ</span><span class="n">staticç­‰</span>  
	<span class="n">getReturnType</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å¾—æ–¹æ³•çš„è¿”å›ç±»å‹</span>  
	<span class="n">getParameterTypes</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å¾—æ–¹æ³•çš„å‚æ•°ç±»å‹</span>

	<span class="n">getConstructors</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å¾—ç±»çš„publicç±»å‹çš„æ„é€ æ–¹æ³•</span><span class="err">ã€‚</span>  
	<span class="n">getConstructor</span><span class="o">(</span><span class="nc">Class</span><span class="o">[]</span> <span class="n">parameterTypes</span><span class="o">)</span><span class="err">ï¼š</span><span class="n">è·å¾—ç±»çš„ç‰¹å®šæ„é€ æ–¹æ³•</span><span class="err">ã€‚</span>
	
	<span class="n">getSuperclass</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å–æŸç±»çš„çˆ¶ç±»</span>  
	<span class="n">getInterfaces</span><span class="o">()</span><span class="err">ï¼š</span><span class="n">è·å–æŸç±»å®ç°çš„æ¥å£</span>
</code></pre></div></div>

<p>ç¤ºä¾‹ä¸€ï¼šè·å¾—ç±»çš„æ‰€æœ‰æ–¹æ³•ï¼ˆMethodï¼‰ä¿¡æ¯</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="kd">private</span> <span class="kt">void</span> <span class="nf">getMethodsInfo</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Class</span><span class="o">&lt;</span><span class="nc">ReflectionActivity</span><span class="o">&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="nc">ReflectionActivity</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
        <span class="nc">Method</span><span class="o">[]</span> <span class="n">methods</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="na">getDeclaredMethods</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">methods</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span><span class="o">;</span>

        <span class="nc">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Method</span> <span class="nl">method:</span><span class="n">methods</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="nc">Modifier</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">getModifiers</span><span class="o">())).</span><span class="na">append</span><span class="o">(</span><span class="s">" "</span><span class="o">);</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">getReturnType</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">" "</span><span class="o">);</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">getName</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">"("</span><span class="o">);</span>
            <span class="nc">Class</span><span class="o">[]</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">getParameterTypes</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">parameters</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">parameters</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                    <span class="nc">Class</span> <span class="n">paramCls</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
                    <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">paramCls</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">());</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">parameters</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">", "</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">")\n\n"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">tvInfo</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>è¿è¡Œç»“æœå¦‚ä¸‹å›¾ï¼š</p>

<p><img src="/assets/2016/reflection_icon1.png" style="width: 50%;" /></p>

<p>ç¤ºä¾‹ä¸€ï¼šè·å¾—ç±»çš„æ‰€æœ‰å±æ€§ï¼ˆFieldï¼‰ä¿¡æ¯ï¼Œå¹¶ä¿®æ”¹ç±»å‹Intå±æ€§içš„å€¼</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">modifyFieldValue</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Class</span><span class="o">&lt;</span><span class="nc">ReflectionActivity</span><span class="o">&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="nc">ReflectionActivity</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
        <span class="nc">Field</span><span class="o">[]</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="na">getDeclaredFields</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">fields</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span><span class="o">;</span>

        <span class="nc">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"è·å¾—ç±»çš„æ‰€æœ‰å±æ€§ä¿¡æ¯ï¼š\n\n"</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Field</span> <span class="nl">field:</span><span class="n">fields</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="nc">Modifier</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">field</span><span class="o">.</span><span class="na">getModifiers</span><span class="o">())).</span><span class="na">append</span><span class="o">(</span><span class="s">" "</span><span class="o">);</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">field</span><span class="o">.</span><span class="na">getType</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">" "</span><span class="o">);</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">field</span><span class="o">.</span><span class="na">getName</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">";"</span><span class="o">);</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"\n\n"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"å±æ€§içš„é»˜è®¤å€¼ï¼ši = "</span><span class="o">);</span>
            <span class="nc">Field</span> <span class="n">f</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">"i"</span><span class="o">);</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"i"</span><span class="o">)).</span><span class="na">append</span><span class="o">(</span><span class="s">"\n\n"</span><span class="o">);</span>
            <span class="n">f</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"i"</span><span class="o">,</span> <span class="mi">100</span><span class="o">);</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"å±æ€§iä¿®æ”¹åçš„å€¼ï¼ši = "</span><span class="o">);</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"i"</span><span class="o">)).</span><span class="na">append</span><span class="o">(</span><span class="s">"\n\n"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="n">tvInfo</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="na">setSubtitle</span><span class="o">(</span><span class="s">"ä¿®æ”¹ç±»å‹Intå±æ€§içš„å€¼"</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>è¿è¡Œç»“æœå¦‚ä¸‹å›¾ï¼š</p>

<p><img src="/assets/2016/reflection_icon2.png" style="width: 50%;" /></p>

<p>æ›´å¤šç¤ºä¾‹è¯·å‚è€ƒ <a href="https://github.com/sfsheng0322/In-depthStudy">ã€ä¸ªäººå­¦ä¹ é¡¹ç›®DroidStudyã€‘</a></p>

<p>åå°„çš„ç›¸å…³å†…å®¹å…ˆè®°å½•åˆ°è¿™ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹æ³¨è§£ç›¸å…³æ¦‚å¿µä¸ä½¿ç”¨ã€‚</p>

<h2 id="-æ³¨è§£annotation">â— æ³¨è§£ï¼ˆAnnotationï¼‰</h2>

<h4 id="æ³¨è§£çš„æ¦‚å¿µ">æ³¨è§£çš„æ¦‚å¿µ</h4>

<p>æ³¨è§£ï¼ˆAnnotationï¼‰ï¼Œä¹Ÿå«å…ƒæ•°æ®ã€‚ä¸€ç§ä»£ç çº§åˆ«çš„è¯´æ˜ã€‚å®ƒæ˜¯JDK 1.5åŠä»¥åç‰ˆæœ¬å¼•å…¥çš„ä¸€ä¸ªç‰¹æ€§ï¼Œä¸ç±»ã€æ¥å£ã€æšä¸¾æ˜¯åœ¨åŒä¸€ä¸ªå±‚æ¬¡ã€‚å®ƒå¯ä»¥å£°æ˜åœ¨åŒ…ã€ç±»ã€å­—æ®µã€æ–¹æ³•ã€å±€éƒ¨å˜é‡ã€æ–¹æ³•å‚æ•°ç­‰çš„å‰é¢ï¼Œç”¨æ¥å¯¹è¿™äº›å…ƒç´ è¿›è¡Œè¯´æ˜ï¼Œæ³¨é‡Šã€‚</p>

<h4 id="æ³¨è§£çš„ä½œç”¨">æ³¨è§£çš„ä½œç”¨</h4>

<p>1ã€æ ‡è®°ä½œç”¨ï¼Œç”¨äºå‘Šè¯‰ç¼–è¯‘å™¨ä¸€äº›ä¿¡æ¯è®©ç¼–è¯‘å™¨èƒ½å¤Ÿå®ç°åŸºæœ¬çš„ç¼–è¯‘æ£€æŸ¥ï¼Œå¦‚@Overrideã€Deprecatedï¼Œçœ‹ä¸‹å®ƒä¿©çš„æºç </p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">)</span>
	<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">SOURCE</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Override</span> <span class="o">{</span>
	<span class="o">}</span>
	
	<span class="nd">@Documented</span>
	<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Deprecated</span> <span class="o">{</span>
	<span class="o">}</span>
</code></pre></div></div>

<p>2ã€ç¼–è¯‘æ—¶åŠ¨æ€å¤„ç†ï¼ŒåŠ¨æ€ç”Ÿæˆä»£ç ï¼Œå¦‚<a href="https://github.com/JakeWharton/butterknife">Butter Knife</a>ã€<a href="https://github.com/google/dagger">Dagger 2</a></p>

<p>3ã€è¿è¡Œæ—¶åŠ¨æ€å¤„ç†ï¼Œè·å¾—æ³¨è§£ä¿¡æ¯ï¼Œå¦‚<a href="https://github.com/square/retrofit">Retrofit</a></p>

<h4 id="æ³¨è§£çš„åˆ†ç±»">æ³¨è§£çš„åˆ†ç±»</h4>

<p>æ³¨è§£çš„åˆ†ç±»æœ‰ä¸¤ç§åˆ†æ³•ï¼š</p>

<h5 id="ç¬¬ä¸€ç§åˆ†æ³•">ç¬¬ä¸€ç§åˆ†æ³•</h5>

<p>1ã€åŸºæœ¬å†…ç½®æ³¨è§£ï¼Œæ˜¯æŒ‡Javaè‡ªå¸¦çš„å‡ ä¸ªAnnotationï¼Œå¦‚@Overrideã€Deprecatedã€@SuppressWarningsç­‰</p>

<p>2ã€å…ƒæ³¨è§£ï¼ˆmeta-annotationï¼‰ï¼Œæ˜¯æŒ‡è´Ÿè´£æ³¨è§£å…¶ä»–æ³¨è§£çš„æ³¨è§£ï¼ŒJDK 1.5åŠä»¥åç‰ˆæœ¬å®šä¹‰äº†4ä¸ªæ ‡å‡†çš„å…ƒæ³¨è§£ç±»å‹ï¼Œå¦‚ä¸‹ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="mi">1</span><span class="err">ã€</span><span class="nd">@Target</span>
	<span class="mi">2</span><span class="err">ã€</span><span class="nd">@Retention</span>
	<span class="mi">3</span><span class="err">ã€</span><span class="nd">@Documented</span>
	<span class="mi">4</span><span class="err">ã€</span><span class="nd">@Inherited</span>
</code></pre></div></div>

<p>3ã€è‡ªå®šä¹‰æ³¨è§£ï¼Œæ ¹æ®éœ€è¦å¯ä»¥è‡ªå®šä¹‰æ³¨è§£ï¼Œè‡ªå®šä¹‰æ³¨è§£éœ€è¦ç”¨åˆ°ä¸Šé¢çš„meta-annotation</p>

<h5 id="ç¬¬äºŒç§åˆ†æ³•æ ¹æ®ä½œç”¨åŸŸåˆ†ç±»">ç¬¬äºŒç§åˆ†æ³•ï¼Œæ ¹æ®ä½œç”¨åŸŸåˆ†ç±»</h5>

<p>1ã€æºç æ—¶æ³¨è§£ï¼ˆRetentionPolicy.SOURCEï¼‰<br />
2ã€ç¼–è¯‘æ—¶æ³¨è§£ï¼ˆRetentionPolicy.CLASSï¼‰<br />
3ã€è¿è¡Œæ—¶æ³¨è§£ï¼ˆRetentionPolicy.RUNTIMEï¼‰</p>

<h4 id="æ³¨è§£ç›¸å…³çŸ¥è¯†ç‚¹">æ³¨è§£ç›¸å…³çŸ¥è¯†ç‚¹</h4>

<p>1ã€å…ƒæ³¨è§£ç›¸å…³ä¿¡æ¯</p>

<p>@Targetï¼šæŒ‡Annotationæ‰€ä¿®é¥°çš„å¯¹è±¡èŒƒå›´ï¼Œé€šè¿‡ElementTypeå–å€¼æœ‰8ç§ï¼Œå¦‚ä¸‹</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="no">TYPE</span><span class="err">ï¼š</span><span class="n">ç±»</span><span class="err">ã€</span><span class="n">æ¥å£</span><span class="err">ï¼ˆ</span><span class="n">åŒ…æ‹¬æ³¨è§£ç±»å‹</span><span class="err">ï¼‰</span><span class="n">æˆ–æšä¸¾</span>
    <span class="no">FIELD</span><span class="err">ï¼š</span><span class="n">å±æ€§</span>
    <span class="no">METHOD</span><span class="err">ï¼š</span><span class="n">æ–¹æ³•</span>
    <span class="no">PARAMETER</span><span class="err">ï¼š</span><span class="n">å‚æ•°</span>
    <span class="no">CONSTRUCTOR</span><span class="err">ï¼š</span><span class="n">æ„é€ å‡½æ•°</span>
    <span class="no">LOCAL_VARIABLE</span><span class="err">ï¼š</span><span class="n">å±€éƒ¨å˜é‡</span>
    <span class="no">ANNOTATION_TYPE</span><span class="err">ï¼š</span><span class="n">æ³¨è§£ç±»å‹</span>
    <span class="no">PACKAGE</span><span class="err">ï¼š</span><span class="n">åŒ…</span>
</code></pre></div></div>

<p>@Retentionï¼šæŒ‡Annotationè¢«ä¿ç•™çš„æ—¶é—´é•¿çŸ­ï¼Œé€šè¿‡RetentionPolicyå–å€¼æœ‰3ç§ï¼Œå¦‚ä¸‹ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="no">SOURCE</span><span class="err">ï¼š</span><span class="n">åœ¨æºæ–‡ä»¶ä¸­æœ‰æ•ˆ</span><span class="err">ï¼ˆ</span><span class="n">å³æºæ–‡ä»¶ä¿ç•™</span><span class="err">ï¼‰</span>  
	<span class="no">CLASS</span><span class="err">ï¼š</span><span class="n">åœ¨classæ–‡ä»¶ä¸­æœ‰æ•ˆ</span><span class="err">ï¼ˆ</span><span class="n">å³classä¿ç•™</span><span class="err">ï¼‰</span>  
	<span class="no">RUNTIME</span><span class="err">ï¼š</span><span class="n">åœ¨è¿è¡Œæ—¶æœ‰æ•ˆ</span><span class="err">ï¼ˆ</span><span class="n">å³è¿è¡Œæ—¶ä¿ç•™</span><span class="err">ï¼‰</span>
</code></pre></div></div>

<p>@Documentedï¼šæ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ï¼Œç”¨äºæè¿°å…¶å®ƒç±»å‹çš„æ³¨è§£åº”è¯¥è¢«ä½œä¸ºè¢«æ ‡æ³¨çš„ç¨‹åºæˆå‘˜çš„å…¬å…±APIï¼Œå› æ­¤å¯ä»¥è¢«ä¾‹å¦‚javadocæ­¤ç±»çš„å·¥å…·æ–‡æ¡£åŒ–ã€‚</p>

<p>@Inheritedï¼šä¹Ÿæ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ï¼Œ@Inheritedé˜è¿°äº†æŸä¸ªè¢«æ ‡æ³¨çš„ç±»å‹æ˜¯è¢«ç»§æ‰¿çš„</p>

<p>2ã€æ³¨è§£å®šä¹‰æ ¼å¼</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="kd">public</span> <span class="nd">@interface</span> <span class="n">æ³¨è§£å</span> <span class="o">{</span> <span class="n">å®šä¹‰ä½“</span> <span class="o">}</span>
</code></pre></div></div>

<p>3ã€æ³¨è§£å‚æ•°å¯æ”¯æŒçš„æ•°æ®ç±»å‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>8ç§åŸºæœ¬æ•°æ®ç±»å‹ intã€floatã€booleanã€byteã€doubleã€charã€longã€short  
Stringã€Classã€enumã€Annotation  
ä»¥ä¸Šæ‰€æœ‰ç±»å‹çš„æ•°ç»„
</code></pre></div></div>

<p>4ã€âš æ³¨æ„ï¼šè‡ªå®šä¹‰æ³¨è§£å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°æˆå‘˜ï¼Œæœ€å¥½æŠŠå®šä¹‰ä½“å‚æ•°åç§°è®¾ä¸ºâ€valueâ€ï¼Œå¦‚@Target</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nd">@Documented</span>
	<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
	<span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">ANNOTATION_TYPE</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Target</span> <span class="o">{</span>
    	<span class="nc">ElementType</span><span class="o">[]</span> <span class="nf">value</span><span class="o">();</span>
	<span class="o">}</span>
</code></pre></div></div>

<h4 id="çœ‹ä¸€ä¸ªç¤ºä¾‹">çœ‹ä¸€ä¸ªç¤ºä¾‹</h4>

<p>å…·ä½“è¦æ±‚å’Œè¿è¡Œç»“æœéƒ½åœ¨ä¸‹é¢è¿™å¼ å›¾ä¸Šæ˜¾ç¤ºå‡ºæ¥äº†ï¼Œè´´ä¸‹å›¾</p>

<p><img src="/assets/2016/annotation_icon.png" style="width: 50%;" /></p>

<p>å†è´´ä¸‰å—ä»£ç ï¼Œé¦–å…ˆæ˜¯è‡ªå®šä¹‰æ³¨è§£ä»£ç ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">)</span>
	<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
	<span class="nd">@Inherited</span>
	<span class="nd">@Documented</span>
	<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">RequestAnnotation</span> <span class="o">{</span>
    	<span class="kt">boolean</span> <span class="nf">withDialog</span><span class="o">()</span> <span class="k">default</span> <span class="kc">true</span><span class="o">;</span>
    	<span class="nc">String</span> <span class="nf">withMessage</span><span class="o">()</span> <span class="k">default</span> <span class="s">"æ­£åœ¨åŠ è½½ï¼Œè¯·ç¨å..."</span><span class="o">;</span>
	<span class="o">}</span>
</code></pre></div></div>

<p>å…¶æ¬¡æ˜¯æ‰§è¡Œæ¨¡æ‹Ÿçš„ç½‘ç»œè¯·æ±‚ï¼Œæ ¸å¿ƒä»£ç æ˜¯é€šè¿‡ä¸Šé¢çš„åå°„å’Œæ³¨è§£å®Œæˆçš„ï¼›å…·ä½“è¯¦ç»†ä»£ç è¯·å‚è€ƒ <a href="https://github.com/sfsheng0322/In-depthStudy">ã€ä¸ªäººå­¦ä¹ é¡¹ç›®DroidStudyã€‘</a>ï¼Œä¸‹æ¬¡ä½¿ç”¨åŠ¨æ€ä»£ç†å’ŒGoogleçš„dexmakerå®Œæˆè¿™ä¸ªåŠŸèƒ½ï¼Œæ•¬è¯·å…³æ³¨ï¼Œå¦‚æœä½ å¯¹çº¿ç¨‹æ± è¿˜ä¸æ¸…æ™°è¯·å‚è€ƒæˆ‘ä»¥å‰çš„æ–‡ç« <a href="http://www.jianshu.com/p/b8197dd2934c">ã€çº¿ç¨‹ã€å¤šçº¿ç¨‹ä¸çº¿ç¨‹æ± æ€»ç»“ã€‘</a>ã€‚è´´ä¸‹æ ¸å¿ƒä»£ç ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="c1">// çº¿ç¨‹æ± </span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">ExecutorService</span> <span class="n">pool</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newCachedThreadPool</span><span class="o">();</span>

	<span class="c1">// æ¨¡æ‹Ÿå¤„ç†ç½‘ç»œè¯·æ±‚</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">process</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">clazz</span><span class="o">,</span> <span class="nc">String</span> <span class="n">methodName</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">Object</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">Class</span><span class="o">[]</span> <span class="n">argsClass</span> <span class="o">=</span> <span class="n">getClazzByArgs</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>

        <span class="kd">final</span> <span class="nc">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">clazz</span><span class="o">.</span><span class="na">getDeclaredMethod</span><span class="o">(</span><span class="n">methodName</span><span class="o">,</span> <span class="n">argsClass</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">method</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sendMsg</span><span class="o">(</span><span class="no">TYPE_ERROR</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="c1">// è·å–æ³¨è§£ä¿¡æ¯</span>
        <span class="nc">RequestAnnotation</span> <span class="n">annotation</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">getAnnotation</span><span class="o">(</span><span class="nc">RequestAnnotation</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">annotation</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">annotation</span><span class="o">.</span><span class="na">withDialog</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">loadingDialog</span><span class="o">.</span><span class="na">show</span><span class="o">(</span><span class="n">annotation</span><span class="o">.</span><span class="na">withMessage</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="n">pool</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="k">new</span> <span class="nc">Runnable</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="n">method</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
                    <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">clazz</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(),</span> <span class="n">args</span><span class="o">);</span>
                    <span class="n">sendMsg</span><span class="o">(</span><span class="no">TYPE_SUCCESS</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>æœ€åæ˜¯è°ƒç”¨ç½‘ç»œè¯·æ±‚æ¥å£ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nd">@RequestAnnotation</span><span class="o">(</span><span class="n">withDialog</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">withMessage</span> <span class="o">=</span> <span class="s">"æ­£åœ¨åŠ è½½ï¼Œè¯·ç¨å..."</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">apiTestFunc</span><span class="o">(</span><span class="nc">String</span> <span class="n">param1</span><span class="o">,</span> <span class="nc">String</span> <span class="n">param2</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚çš„è€—æ—¶æ“ä½œ</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">3000</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="c1">// ç‚¹å‡»æ‰§è¡Œçš„ä»£ç </span>
    <span class="nc">DynamicProxyUtil</span> <span class="n">proxyUtil</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DynamicProxyUtil</span><span class="o">(</span><span class="nc">AnnotationActivity</span><span class="o">.</span><span class="na">this</span><span class="o">);</span>
	<span class="n">proxyUtil</span><span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="nc">RequestNetworkApi</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"apiTestFunc"</span><span class="o">,</span> <span class="s">"å‚æ•°ä¸€"</span><span class="o">,</span> <span class="s">"å‚æ•°äºŒ"</span><span class="o">);</span>
</code></pre></div></div>

<h2 id="-ä¾èµ–æ³¨å…¥dependency-injection">â— ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰</h2>

<p>ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰ï¼šå¯ä»¥é€šè¿‡è¿™ä¸ªæœåŠ¡æ¥å®‰å…¨çš„æ³¨å…¥ç»„ä»¶åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œåœ¨åº”ç”¨ç¨‹åºéƒ¨ç½²çš„æ—¶å€™è¿˜å¯ä»¥é€‰æ‹©ä»ç‰¹å®šçš„æ¥å£å±æ€§è¿›è¡Œæ³¨å…¥ã€‚</p>

<p>çœ‹å®Œä¸Šé¢åå°„å’Œæ³¨è§£çš„è®°å½•åï¼Œå¯ä»¥æ›´å¥½çš„ç†è§£ä¾èµ–æ³¨å…¥ï¼Œå¦‚æœä½ ä¸ç”¨é‚£äº›ç¬¬ä¸‰æ–¹çš„æ³¨å…¥åº“ä½ ä¹Ÿåœ¨ç»å¸¸ç”¨åˆ°ä¾èµ–æ³¨å…¥ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸€æ®µä»<a href="http://p.codekk.com/">codekk</a>ä¸Šæˆªå–çš„ä»£ç ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Human</span> <span class="o">{</span>
    	<span class="o">...</span>
    	<span class="nc">Father</span> <span class="n">father</span><span class="o">;</span>
    	<span class="o">...</span>
    	<span class="kd">public</span> <span class="nf">Human</span><span class="o">(</span><span class="nc">Father</span> <span class="n">father</span><span class="o">)</span> <span class="o">{</span>
        	<span class="k">this</span><span class="o">.</span><span class="na">father</span> <span class="o">=</span> <span class="n">father</span><span class="o">;</span>
    	<span class="o">}</span>
	<span class="o">}</span>
</code></pre></div></div>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°† father å¯¹è±¡ä½œä¸ºæ„é€ å‡½æ•°çš„ä¸€ä¸ªå‚æ•°ä¼ å…¥ã€‚åœ¨è°ƒç”¨ Human çš„æ„é€ æ–¹æ³•ä¹‹å‰å¤–éƒ¨å°±å·²ç»åˆå§‹åŒ–å¥½äº† Father å¯¹è±¡ã€‚åƒè¿™ç§éè‡ªå·±ä¸»åŠ¨åˆå§‹åŒ–ä¾èµ–ï¼Œè€Œé€šè¿‡å¤–éƒ¨æ¥ä¼ å…¥ä¾èµ–çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°±ç§°ä¸ºä¾èµ–æ³¨å…¥ã€‚</p>

<p>ä¾èµ–æ³¨å…¥çš„å®ç°æœ‰å¤šç§é€”å¾„ï¼Œè€Œåœ¨ Java ä¸­ï¼Œä½¿ç”¨æ³¨è§£æ˜¯æœ€å¸¸ç”¨çš„ã€‚æ¯”å¦‚é€šè¿‡Butter Knifeã€Daggerä¾èµ–æ³¨å…¥åº“å®ç°ï¼Œéƒ½æ˜¯ä½¿ç”¨æ³¨è§£æ¥å®ç°ä¾èµ–æ³¨å…¥ï¼Œä½†å®ƒåˆ©ç”¨ APT(Annotation Process Tool) åœ¨ç¼–è¯‘æ—¶ç”Ÿæˆè¾…åŠ©ç±»ï¼Œè¿™äº›ç±»ç»§æ‰¿ç‰¹å®šçˆ¶ç±»æˆ–å®ç°ç‰¹å®šæ¥å£ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶åŠ è½½è¿™äº›è¾…åŠ©ç±»ï¼Œè°ƒç”¨ç›¸åº”æ¥å£å®Œæˆä¾èµ–ç”Ÿæˆå’Œæ³¨å…¥ã€‚</p>

<p>ä¾èµ–æ³¨å…¥åœ¨è¿™é‡Œä»…ä»…å‰–æä¸‹æ¦‚å¿µï¼Œæœ‰æ—¶é—´å°†ä¼šè¡¥ä¸€ä¸ªä¾‹å­ï¼Œæš‚ä¸”åˆ°è¿™å§ã€‚</p>

:ET